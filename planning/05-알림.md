# ì•Œë¦¼ (Notification) ë„ë©”ì¸

## ê°œìš”
í‘¸ì‹œ ì•Œë¦¼ ë° ì¸ì•± ì•Œë¦¼ì„ í†µí•´ ì‚¬ìš©ìì—ê²Œ ì£¼ìš” ì´ë²¤íŠ¸ë¥¼ ì „ë‹¬

### ì•Œë¦¼ ì‹œìŠ¤í…œ êµ¬ì„±

| êµ¬ì„± ìš”ì†Œ | ì—­í•  | ì €ì¥ì†Œ |
|----------|------|--------|
| **notifications í…Œì´ë¸”** | ì•Œë¦¼ íˆìŠ¤í† ë¦¬ ì €ì¥ (ì•± ë‚´ ì•Œë¦¼ ì„¼í„°ìš©) | DB |
| **í‘¸ì‹œ ì•Œë¦¼** | ì‹¤ì‹œê°„ ì•Œë¦¼ ì „ë‹¬ (ì•±ì´ êº¼ì ¸ìˆì–´ë„ ê¸°ê¸°ì— í‘œì‹œ) | - |
| **push_tokens í…Œì´ë¸”** | í‘¸ì‹œ ë°œì†¡ì„ ìœ„í•œ ê¸°ê¸° ì£¼ì†Œ ì €ì¥ | DB |

```
ì´ë²¤íŠ¸ ë°œìƒ (ì˜ˆ: Aê°€ Bì—ê²Œ ëª…í•¨ ì „ì†¡)
         â”‚
         â”œâ”€â”€â–º notifications í…Œì´ë¸” ì €ì¥
         â”‚    â†’ Bê°€ ì•±ì—ì„œ "ì•Œë¦¼ ì„¼í„°" ì¡°íšŒ ì‹œ ì‚¬ìš©
         â”‚
         â””â”€â”€â–º í‘¸ì‹œ ì•Œë¦¼ ë°œì†¡ (push_tokens ì¡°íšŒ í›„)
              â†’ Bì˜ ê¸°ê¸° ì ê¸ˆí™”ë©´ì— ì¦‰ì‹œ í‘œì‹œ
```

### í‘¸ì‹œ í† í°ì´ë€?
- í‘¸ì‹œ ì•Œë¦¼ì€ íŠ¹ì • "ê¸°ê¸°"ì— ë°œì†¡í•˜ëŠ” ê²ƒ
- ì„œë²„ëŠ” ì‚¬ìš©ìì˜ ê¸°ê¸° ì£¼ì†Œë¥¼ ì•Œì•„ì•¼ í‘¸ì‹œë¥¼ ë³´ë‚¼ ìˆ˜ ìˆìŒ
- **í‘¸ì‹œ í† í° = ê¸°ê¸°ì˜ ê³ ìœ  ì£¼ì†Œ** (ì˜ˆ: `ExponentPushToken[abc123...]`)
- ì•± ì„¤ì¹˜/ë¡œê·¸ì¸ ì‹œ ê¸°ê¸°ì—ì„œ í† í°ì„ ë°œê¸‰ë°›ì•„ ì„œë²„ì— ë“±ë¡

```
ì›¹ ë¹„ìœ : ì´ë©”ì¼ ë³´ë‚´ë ¤ë©´ ì´ë©”ì¼ ì£¼ì†Œ í•„ìš”
ì•± ë¹„ìœ : í‘¸ì‹œ ë³´ë‚´ë ¤ë©´ í‘¸ì‹œ í† í° í•„ìš”
```

---

## ì—”í‹°í‹°

### PushToken
| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | string | í† í° ID |
| memberId | string | íšŒì› ID |
| token | string | Expo Push Token |
| platform | string | í”Œë«í¼ (ios, android) |
| createdAt | datetime | ë“±ë¡ì¼ì‹œ |
| updatedAt | datetime | ê°±ì‹ ì¼ì‹œ |

### Notification
| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
|------|------|------|
| id | string | ì•Œë¦¼ ID |
| memberId | string | ìˆ˜ì‹ ì ID |
| type | string | ì•Œë¦¼ íƒ€ì… |
| title | string | ì•Œë¦¼ ì œëª© |
| body | string | ì•Œë¦¼ ë‚´ìš© |
| data | object | ì¶”ê°€ ë°ì´í„° (ë”¥ë§í¬ìš©) |
| isRead | boolean | ì½ìŒ ì—¬ë¶€ |
| createdAt | datetime | ìƒì„±ì¼ì‹œ |

---

## ì•Œë¦¼ íƒ€ì…

| íƒ€ì… | ì„¤ëª… | data í•„ë“œ |
|------|------|-----------|
| CARD_EXCHANGE_REQUEST | ëª…í•¨ êµí™˜ ìš”ì²­ ë°›ìŒ | { exchangeId } |
| CARD_EXCHANGE_ACCEPTED | êµí™˜ ìš”ì²­ ìˆ˜ë½ë¨ | { exchangeId, cardBookId } |
| CARD_EXCHANGE_REJECTED | êµí™˜ ìš”ì²­ ê±°ì ˆë¨ | { exchangeId } |

### í–¥í›„ ì¶”ê°€ ê°€ëŠ¥
| íƒ€ì… | ì„¤ëª… |
|------|------|
| CARD_UPDATED | ì €ì¥í•œ ëª…í•¨ ì •ë³´ ì—…ë°ì´íŠ¸ |
| MEETING_REMINDER | ë¯¸íŒ… ë¦¬ë§ˆì¸ë” |
| SYSTEM_NOTICE | ì‹œìŠ¤í…œ ê³µì§€ì‚¬í•­ |

---

## ê·œì¹™ ë° ì •ì±…

### í‘¸ì‹œ í† í° ê·œì¹™
| ê·œì¹™ | ë‚´ìš© |
|------|------|
| ë“±ë¡ ì‹œì  | ë¡œê·¸ì¸ ì„±ê³µ í›„ |
| ì‚­ì œ ì‹œì  | ë¡œê·¸ì•„ì›ƒ ì‹œ |
| ë‹¤ì¤‘ ê¸°ê¸° | í•œ íšŒì›ì´ ì—¬ëŸ¬ ê¸°ê¸° ë“±ë¡ ê°€ëŠ¥ |
| í† í° ìœ ì¼ì„± | ë™ì¼ í† í°ì€ í•œ íšŒì›ì—ê²Œë§Œ ê·€ì† |
| í† í° ê°±ì‹  | ì•± ì‹¤í–‰ ì‹œ í† í° ì¬ë“±ë¡ (ìë™ ê°±ì‹ ) |

### í‘¸ì‹œ ì•Œë¦¼ ê·œì¹™
| ê·œì¹™ | ë‚´ìš© |
|------|------|
| ë°œì†¡ ì¡°ê±´ | ìˆ˜ì‹ ìê°€ í‘¸ì‹œ í† í° ë“±ë¡ëœ íšŒì› |
| ë°œì†¡ ë°©ì‹ | Expo Push Service ì‚¬ìš© |
| ì‹¤íŒ¨ ì²˜ë¦¬ | ìœ íš¨í•˜ì§€ ì•Šì€ í† í°ì€ ìë™ ì‚­ì œ |

### ì¸ì•± ì•Œë¦¼ ê·œì¹™
| ê·œì¹™ | ë‚´ìš© |
|------|------|
| ì €ì¥ | ëª¨ë“  ì•Œë¦¼ì€ DBì— ì €ì¥ |
| ë³´ê´€ ê¸°ê°„ | ìµœê·¼ 90ì¼ |
| ì½ìŒ ì²˜ë¦¬ | ê°œë³„ ë˜ëŠ” ì „ì²´ ì½ìŒ ê°€ëŠ¥ |
| ì‚­ì œ | ìˆ˜ë™ ì‚­ì œ ê°€ëŠ¥ |

---

## ê¸°ëŠ¥

### 1. í‘¸ì‹œ í† í° ë“±ë¡
- ë¡œê·¸ì¸ ì‹œ ê¸°ê¸°ì˜ í‘¸ì‹œ í† í° ì„œë²„ì— ë“±ë¡
- ì•± ì‹¤í–‰ ì‹œ í† í° ê°±ì‹ 

### 2. í‘¸ì‹œ ì•Œë¦¼ ë°œì†¡
- ëª…í•¨ êµí™˜ ìš”ì²­ ì‹œ ìƒëŒ€ë°©ì—ê²Œ í‘¸ì‹œ ë°œì†¡
- êµí™˜ ìˆ˜ë½/ê±°ì ˆ ì‹œ ìš”ì²­ìì—ê²Œ í‘¸ì‹œ ë°œì†¡

### 3. ì•Œë¦¼ ì„¼í„°
- ë°›ì€ ì•Œë¦¼ ëª©ë¡ ì¡°íšŒ
- ì½ìŒ/ì•ˆì½ìŒ ìƒíƒœ í‘œì‹œ
- ì•Œë¦¼ íƒ­ ì‹œ í•´ë‹¹ í™”ë©´ìœ¼ë¡œ ì´ë™

### 4. ì•Œë¦¼ ë°°ì§€
- ì•ˆì½ì€ ì•Œë¦¼ ê°œìˆ˜ í‘œì‹œ
- íƒ­ë°” ë° ì•± ì•„ì´ì½˜ ë°°ì§€

---

## ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: ëª…í•¨ êµí™˜ ìš”ì²­ ì•Œë¦¼
```
1. Aê°€ Bì˜ ëª…í•¨ ìŠ¤ìº” í›„ ì €ì¥
2. "ë‚´ ëª…í•¨ë„ ì „ì†¡í•˜ì‹œê² ìŠµë‹ˆê¹Œ?" â†’ [ì˜ˆ] í´ë¦­
3. ì„œë²„ì—ì„œ Bì—ê²Œ í‘¸ì‹œ ì•Œë¦¼ ë°œì†¡
4. Bì˜ ê¸°ê¸°ì— ì•Œë¦¼ í‘œì‹œ: "Aë‹˜ì´ ëª…í•¨ì„ ë³´ëƒˆìŠµë‹ˆë‹¤"
5. Bê°€ ì•Œë¦¼ íƒ­
6. ì•± ì—´ë¦¬ë©° Aì˜ ëª…í•¨ í™”ë©´ í‘œì‹œ
7. Bê°€ [ìˆ˜ë½] í´ë¦­ â†’ Aì˜ ëª…í•¨ ì €ì¥ë¨
```

### ì‹œë‚˜ë¦¬ì˜¤ 2: êµí™˜ ìˆ˜ë½ ì•Œë¦¼
```
1. Bê°€ Aì˜ êµí™˜ ìš”ì²­ ìˆ˜ë½
2. ì„œë²„ì—ì„œ Aì—ê²Œ í‘¸ì‹œ ì•Œë¦¼ ë°œì†¡
3. Aì˜ ê¸°ê¸°ì— ì•Œë¦¼: "Bë‹˜ì´ ëª…í•¨ êµí™˜ì„ ìˆ˜ë½í–ˆìŠµë‹ˆë‹¤"
4. Aê°€ ì•Œë¦¼ íƒ­ â†’ Bì˜ ëª…í•¨ ìƒì„¸ í™”ë©´ìœ¼ë¡œ ì´ë™
```

### ì‹œë‚˜ë¦¬ì˜¤ 3: ì•Œë¦¼ ì„¼í„° ì¡°íšŒ
```
1. í™ˆ í™”ë©´ â†’ ì•Œë¦¼ ì•„ì´ì½˜ í´ë¦­ (ë°°ì§€: 3)
2. ì•Œë¦¼ ëª©ë¡ í‘œì‹œ
3. ì•ˆì½ì€ ì•Œë¦¼ì€ ê°•ì¡° í‘œì‹œ
4. ì•Œë¦¼ íƒ­ â†’ í•´ë‹¹ í™”ë©´ ì´ë™ + ì½ìŒ ì²˜ë¦¬
5. [ëª¨ë‘ ì½ìŒ] í´ë¦­ â†’ ì „ì²´ ì½ìŒ ì²˜ë¦¬
```

### ì‹œë‚˜ë¦¬ì˜¤ 4: ì•±ì´ êº¼ì ¸ìˆì„ ë•Œ
```
1. Aê°€ Bì—ê²Œ ëª…í•¨ ì „ì†¡
2. Bì˜ ê¸°ê¸° ì ê¸ˆí™”ë©´ì— í‘¸ì‹œ ì•Œë¦¼ í‘œì‹œ
3. Bê°€ ì•Œë¦¼ íƒ­ â†’ ì•± ì‹¤í–‰ â†’ í•´ë‹¹ í™”ë©´ ì´ë™
```

---

## í™”ë©´

### ì•Œë¦¼ ì„¼í„°
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† ì•Œë¦¼                     â”‚
â”‚                             â”‚
â”‚  â”€â”€ ì˜¤ëŠ˜ â”€â”€                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ”µ ëª…í•¨ êµí™˜ ìš”ì²­     â”‚   â”‚
â”‚  â”‚ í™ê¸¸ë™ë‹˜ì´ ëª…í•¨ì„     â”‚   â”‚
â”‚  â”‚ ë³´ëƒˆìŠµë‹ˆë‹¤            â”‚   â”‚
â”‚  â”‚              ì˜¤í›„ 2:30â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â—‹ ëª…í•¨ êµí™˜ ìˆ˜ë½      â”‚   â”‚
â”‚  â”‚ ê¹€ì² ìˆ˜ë‹˜ì´ ëª…í•¨ êµí™˜ì„â”‚   â”‚
â”‚  â”‚ ìˆ˜ë½í–ˆìŠµë‹ˆë‹¤          â”‚   â”‚
â”‚  â”‚              ì˜¤ì „ 11:00â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚
â”‚  â”€â”€ ì–´ì œ â”€â”€                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â—‹ ëª…í•¨ êµí™˜ ìš”ì²­      â”‚   â”‚
â”‚  â”‚ ì´ì˜í¬ë‹˜ì´ ëª…í•¨ì„     â”‚   â”‚
â”‚  â”‚ ë³´ëƒˆìŠµë‹ˆë‹¤            â”‚   â”‚
â”‚  â”‚              ì˜¤í›„ 5:00â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚
â”‚        [ëª¨ë‘ ì½ìŒìœ¼ë¡œ í‘œì‹œ]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”µ = ì•ˆì½ìŒ, â—‹ = ì½ìŒ
```

### êµí™˜ ìš”ì²­ ìƒì„¸ (ì•Œë¦¼ íƒ­ ì‹œ)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† ëª…í•¨ êµí™˜ ìš”ì²­            â”‚
â”‚                             â”‚
â”‚     [í”„ë¡œí•„ ì‚¬ì§„]            â”‚
â”‚     í™ê¸¸ë™                   â”‚
â”‚     Product Manager         â”‚
â”‚     ABC Company             â”‚
â”‚                             â”‚
â”‚  ğŸ“ 010-1234-5678           â”‚
â”‚  âœ‰ï¸  hong@abc.com           â”‚
â”‚                             â”‚
â”‚  í™ê¸¸ë™ë‹˜ì´ ëª…í•¨ì„           â”‚
â”‚  ë³´ëƒˆìŠµë‹ˆë‹¤.                 â”‚
â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ê±°ì ˆ   â”‚ â”‚  ìˆ˜ë½   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í‘¸ì‹œ ì•Œë¦¼ (ì‹œìŠ¤í…œ)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Scanly                      â”‚
â”‚ í™ê¸¸ë™ë‹˜ì´ ëª…í•¨ì„ ë³´ëƒˆìŠµë‹ˆë‹¤  â”‚
â”‚ íƒ­í•˜ì—¬ í™•ì¸í•˜ê¸°              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## í”Œë¡œìš°

### í‘¸ì‹œ í† í° ë“±ë¡ í”Œë¡œìš°
```
[ì•± ì‹¤í–‰]
    â”‚
    â–¼
[ë¡œê·¸ì¸ ì„±ê³µ]
    â”‚
    â–¼
[í‘¸ì‹œ ê¶Œí•œ ìš”ì²­]
    â”‚
    â”œâ”€â†’ ê±°ë¶€ â†’ ì•Œë¦¼ ìˆ˜ì‹  ë¶ˆê°€ ì•ˆë‚´
    â”‚
    â””â”€â†’ í—ˆìš©
          â”‚
          â–¼
    [Expo Push Token ë°œê¸‰]
          â”‚
          â–¼
    [ì„œë²„ì— í† í° ë“±ë¡]
    POST /api/push-tokens
```

### ëª…í•¨ êµí™˜ ì•Œë¦¼ í”Œë¡œìš°
```
[A: "ë‚´ ëª…í•¨ ì „ì†¡" í´ë¦­]
    â”‚
    â–¼
[ì„œë²„: êµí™˜ ìš”ì²­ ìƒì„±]
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. card_exchanges í…Œì´ë¸”ì— ìš”ì²­ ì €ì¥    â”‚
â”‚  2. notifications í…Œì´ë¸”ì— ì•Œë¦¼ ì €ì¥     â”‚  â† ì•Œë¦¼ íˆìŠ¤í† ë¦¬ìš©
â”‚  3. Bì˜ push_tokens ì¡°íšŒ                â”‚
â”‚  4. Expo Push API í˜¸ì¶œ                  â”‚  â† ì‹¤ì‹œê°„ ì•Œë¦¼ìš©
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
[B ê¸°ê¸°ì— í‘¸ì‹œ ì•Œë¦¼ í‘œì‹œ]
    â”‚
    â–¼
[Bê°€ ì•Œë¦¼ íƒ­]
    â”‚
    â–¼
[ì•± ì—´ë¦¼ + ë”¥ë§í¬]
    â”‚
    â–¼
[êµí™˜ ìš”ì²­ ìƒì„¸ í™”ë©´]
    â”‚
    â”œâ”€â†’ [ìˆ˜ë½] â†’ A ëª…í•¨ ì €ì¥ + Aì—ê²Œ ì•Œë¦¼
    â”‚
    â””â”€â†’ [ê±°ì ˆ] â†’ Aì—ê²Œ ì•Œë¦¼ (ì„ íƒ)
```

---

## API

### í‘¸ì‹œ í† í°
| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| POST | /api/push-tokens | í† í° ë“±ë¡/ê°±ì‹  |
| POST | /api/push-tokens/delete | í† í° ì‚­ì œ (ë¡œê·¸ì•„ì›ƒ ì‹œ) |

### ì•Œë¦¼
| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| GET | /api/notifications | ì•Œë¦¼ ëª©ë¡ |
| GET | /api/notifications/unread-count | ì•ˆì½ì€ ì•Œë¦¼ ìˆ˜ |
| POST | /api/notifications/:id/read | ì½ìŒ ì²˜ë¦¬ |
| POST | /api/notifications/read-all | ì „ì²´ ì½ìŒ |
| POST | /api/notifications/:id/delete | ì•Œë¦¼ ì‚­ì œ |

> ëª…í•¨ êµí™˜ ê´€ë ¨ APIëŠ” [03-ëª…í•¨ì²©.md](./03-ëª…í•¨ì²©.md) ì°¸ê³ 

---

## API ìƒì„¸

### POST /api/push-tokens
```json
// Request
{
  "token": "ExponentPushToken[xxxxxx]",
  "platform": "ios"
}

// Response: 201 Created
{
  "id": "uuid",
  "token": "ExponentPushToken[xxxxxx]",
  "platform": "ios",
  "createdAt": "2024-01-01T00:00:00Z"
}
```

### GET /api/notifications
```json
// Query: ?page=0&size=20&unreadOnly=false

// Response
{
  "notifications": [
    {
      "id": "uuid",
      "type": "CARD_EXCHANGE_REQUEST",
      "title": "ëª…í•¨ êµí™˜ ìš”ì²­",
      "body": "í™ê¸¸ë™ë‹˜ì´ ëª…í•¨ì„ ë³´ëƒˆìŠµë‹ˆë‹¤",
      "data": {
        "exchangeId": "uuid"
      },
      "isRead": false,
      "createdAt": "2024-01-01T00:00:00Z"
    }
  ],
  "page": 0,
  "size": 20,
  "totalElements": 1,
  "totalPages": 1
}
```

---

## DB ìŠ¤í‚¤ë§ˆ

```sql
-- í‘¸ì‹œ í† í°
CREATE TABLE push_tokens (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    member_id UUID NOT NULL REFERENCES members(id) ON DELETE CASCADE,
    token VARCHAR(255) NOT NULL UNIQUE,
    platform VARCHAR(20) NOT NULL CHECK (platform IN ('ios', 'android')),
    created_at TIMESTAMP NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP NOT NULL DEFAULT NOW()
);

CREATE INDEX idx_push_tokens_member ON push_tokens(member_id);

-- ì•Œë¦¼
CREATE TABLE notifications (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    member_id UUID NOT NULL REFERENCES members(id) ON DELETE CASCADE,
    type VARCHAR(50) NOT NULL,
    title VARCHAR(255) NOT NULL,
    body TEXT,
    data JSONB,
    is_read BOOLEAN NOT NULL DEFAULT FALSE,
    created_at TIMESTAMP NOT NULL DEFAULT NOW()
);

CREATE INDEX idx_notifications_member ON notifications(member_id, created_at DESC);
CREATE INDEX idx_notifications_unread ON notifications(member_id) WHERE is_read = FALSE;
```

---

## í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„ ê°€ì´ë“œ

### í‘¸ì‹œ í† í° ë“±ë¡ (Expo)
```typescript
import * as Notifications from 'expo-notifications';
import * as Device from 'expo-device';
import { Platform } from 'react-native';

async function registerPushToken() {
  if (!Device.isDevice) return null;

  const { status } = await Notifications.requestPermissionsAsync();
  if (status !== 'granted') return null;

  const token = await Notifications.getExpoPushTokenAsync({
    projectId: 'your-project-id',
  });

  await api.post('/api/push-tokens', {
    token: token.data,
    platform: Platform.OS,
  });

  return token.data;
}
```

### í‘¸ì‹œ ì•Œë¦¼ ìˆ˜ì‹  ì²˜ë¦¬
```typescript
// ì•± í¬ê·¸ë¼ìš´ë“œì—ì„œ ì•Œë¦¼ ìˆ˜ì‹ 
Notifications.addNotificationReceivedListener((notification) => {
  // ì¸ì•± í† ìŠ¤íŠ¸ í‘œì‹œ (ì„ íƒ)
});

// ì•Œë¦¼ íƒ­ ì‹œ
Notifications.addNotificationResponseReceivedListener((response) => {
  const { data } = response.notification.request.content;

  if (data.exchangeId) {
    router.push(`/card-exchanges/${data.exchangeId}`);
  }
});
```

---

## ê°œë°œ ìš°ì„ ìˆœìœ„
1. Phase 1: í‘¸ì‹œ í† í° ë“±ë¡, ëª…í•¨ êµí™˜ ì•Œë¦¼ ë°œì†¡/ìˆ˜ì‹ 
2. Phase 2: ì•Œë¦¼ ì„¼í„° UI, ì½ìŒ ì²˜ë¦¬, ë°°ì§€
3. Phase 3: ì•Œë¦¼ ì„¤ì • (ìˆ˜ì‹  on/off)
